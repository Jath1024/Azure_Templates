- name: Create registry path MyCompany
  win_regedit:
    path: HKCU:\Software\MyCompany

- name: Add or update registry path MyCompany, with entry 'hello', and containing 'world'
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: world

- name: Add or update registry path MyCompany, with dword entry 'hello', and containing 1337 as the decimal value
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: 1337
    type: dword

- name: Add or update registry path MyCompany, with dword entry 'hello', and containing 0xff2500ae as the hex value
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: 0xff2500ae
    type: dword

- name: Add or update registry path MyCompany, with binary entry 'hello', and containing binary data in hex-string format
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: hex:be,ef,be,ef,be,ef,be,ef,be,ef
    type: binary

- name: Add or update registry path MyCompany, with binary entry 'hello', and containing binary data in yaml format
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: [0xbe,0xef,0xbe,0xef,0xbe,0xef,0xbe,0xef,0xbe,0xef]
    type: binary

- name: Add or update registry path MyCompany, with expand string entry 'hello'
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: '%appdata%\local'
    type: expandstring

- name: Add or update registry path MyCompany, with multi string entry 'hello'
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    data: ['hello', 'world']
    type: multistring

- name: Disable keyboard layout hotkey for all users (changes existing)
  win_regedit:
    path: HKU:\.DEFAULT\Keyboard Layout\Toggle
    name: Layout Hotkey
    data: 3
    type: dword

- name: Disable language hotkey for current users (adds new)
  win_regedit:
    path: HKCU:\Keyboard Layout\Toggle
    name: Language Hotkey
    data: 3
    type: dword

- name: Remove registry path MyCompany (including all entries it contains)
  win_regedit:
    path: HKCU:\Software\MyCompany
    state: absent
    delete_key: yes

- name: Clear the existing (Default) entry at path MyCompany
  win_regedit:
    path: HKCU:\Software\MyCompany
    state: absent
    delete_key: no

- name: Remove entry 'hello' from registry path MyCompany
  win_regedit:
    path: HKCU:\Software\MyCompany
    name: hello
    state: absent

- name: Change default mouse trailing settings for new users
  win_regedit:
    path: HKLM:\ANSIBLE\Control Panel\Mouse
    name: MouseTrails
    data: 10
    type: string
    state: present
    hive: C:\Users\Default\NTUSER.dat

- name: Windows Upate
  win_regedit:
    path: HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate\AU
    name: "{{item.name}}"
    data: "{{item.data}}"
    type: "{{item.type}}"
  with_items:
  -name: AUOptions
   data: 00000004
   type: dword
  -name: AUPowerManagement
   data: 00000001
   type: dword
  -name: AutoInstallMinorUpdates
   data: 00000001
   type: dword
  -name: DetectionFrequency
   data: 0000000a
   type: dword
  -name: DetectionFrequencyEnabled
   data: 00000001
   type: dword
  -name: IncludeRecommendedUpdates
   data: 00000001
   type: dword
  -name: NoAUAsDefaultShutdownOption
   data: 00000001
   type: dword
  -name: NoAUShutdownOption
   data: 00000001
   type: dword
  -name: NoAutoRebootWithLoggedOnUsers
   data: 00000001
   type: dword
  -name: NoAutoUpdate
   data: 00000000
   type: dword
  -name: RebootRelaunchTimeout
   data: 0000000a
   type: dword
  -name: RebootRelaunchTimeoutEnabled
   data: 00000001
   type: dword
  -name: RescheduleWaitTime
   data: 0000000a
   type: dword
  -name: RescheduleWaitTimeEnabled
   data: 00000001
   type: dword
  -name: ScheduledInstallDay
   data: 00000000
   type: dword
  -name: ScheduledInstallTime
   data: 00000003
   type: dword
  -name: UseWUServer
   data: 00000001
   type: dword

- name: Windows Upate
  win_regedit:
    path: HKLM\SOFTWARE\Policies\Microsoft\Windows\WindowsUpdate
    name: "{{item.name}}"
    data: "{{item.data}}"
    type: "{{item.type}}"
  with_items:
  -name: AcceptTrustedPublisherCerts
   data: 00000001
   type: dword
  -name: ElevateNonAdmins
   data: 00000001
   type: dword
  -name: TargetGroup
   data: Workstations
   type: string
  -name: TargetGroupEnabled
   data: 00000000
   type: dword
  -name: WUServer
   data: "http://your-WSUS-server:port" 
   type: string
  -name: WUStatusServer
   data: "http://your-WSUS-server:port"
   type: string
